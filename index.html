<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lua Seel - Secure Script Hosting</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'JetBrains Mono', 'SF Mono', 'Monaco', 'Consolas', monospace;
            background: #0d1117;
            color: #c9d1d9;
            min-height: 100vh;
            line-height: 1.5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #161b22;
            min-height: 100vh;
            border-left: 1px solid #21262d;
            border-right: 1px solid #21262d;
        }

        .header {
            background: #21262d;
            padding: 24px;
            border-bottom: 1px solid #30363d;
        }

        .header h1 {
            font-size: 1.75em;
            font-weight: 600;
            color: #58a6ff;
            margin-bottom: 8px;
        }

        .header p {
            color: #8b949e;
            font-size: 0.9em;
            font-weight: 400;
        }

        .main-content {
            padding: 32px;
        }

        .tabs {
            display: flex;
            margin-bottom: 32px;
            border-bottom: 1px solid #21262d;
        }

        .tab {
            padding: 12px 20px;
            cursor: pointer;
            background: none;
            border: none;
            font-family: inherit;
            font-size: 0.875em;
            font-weight: 500;
            color: #8b949e;
            border-bottom: 2px solid transparent;
            transition: all 0.2s ease;
        }

        .tab:hover {
            color: #c9d1d9;
        }

        .tab.active {
            color: #58a6ff;
            border-bottom-color: #58a6ff;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .section-title {
            color: #f0f6fc;
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #f0f6fc;
            font-size: 0.875em;
            font-weight: 500;
        }

        .form-group input, .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 6px;
            color: #c9d1d9;
            font-family: inherit;
            font-size: 0.875em;
            transition: border-color 0.2s ease;
        }

        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: #58a6ff;
            box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.1);
        }

        .form-group textarea {
            min-height: 200px;
            resize: vertical;
        }

        .btn-primary {
            background: #238636;
            color: #ffffff;
            border: 1px solid #2ea043;
            padding: 10px 20px;
            border-radius: 6px;
            font-family: inherit;
            font-size: 0.875em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-primary:hover {
            background: #2ea043;
            border-color: #3fb950;
        }

        .btn-secondary {
            background: #21262d;
            color: #c9d1d9;
            border: 1px solid #30363d;
            padding: 6px 12px;
            border-radius: 6px;
            font-family: inherit;
            font-size: 0.75em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-secondary:hover {
            background: #30363d;
            border-color: #8b949e;
        }

        .output-panel {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
            font-size: 0.875em;
        }

        .output-panel.success {
            border-color: #238636;
            background: rgba(35, 134, 54, 0.05);
        }

        .output-panel.error {
            border-color: #da3633;
            background: rgba(218, 54, 51, 0.05);
            color: #f85149;
        }

        .output-panel.warning {
            border-color: #d29922;
            background: rgba(210, 153, 34, 0.05);
            color: #f2cc60;
        }

        .code-block {
            background: #010409;
            border: 1px solid #21262d;
            border-radius: 6px;
            padding: 16px;
            margin: 16px 0;
            font-size: 0.8em;
            overflow-x: auto;
            max-height: 300px;
            overflow-y: auto;
        }

        .info-box {
            background: #0c2d6b;
            border: 1px solid #1f6feb;
            border-radius: 6px;
            padding: 16px;
            margin: 16px 0;
            color: #79c0ff;
        }

        .script-card {
            background: #21262d;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 16px;
            transition: border-color 0.2s ease;
        }

        .script-card:hover {
            border-color: #8b949e;
        }

        .script-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .script-title {
            color: #f0f6fc;
            font-weight: 600;
            font-size: 1em;
        }

        .script-id {
            color: #8b949e;
            font-size: 0.75em;
            margin-top: 4px;
        }

        .script-actions {
            display: flex;
            gap: 8px;
        }

        .access-form {
            display: flex;
            gap: 16px;
            align-items: end;
            flex-wrap: wrap;
        }

        .access-form .form-group {
            flex: 1;
            margin-bottom: 0;
            min-width: 200px;
        }

        .prompt {
            color: #58a6ff;
            font-weight: 500;
        }

        .loading {
            color: #f2cc60;
        }

        .loading::after {
            content: '';
            animation: dots 1.5s infinite;
        }

        @keyframes dots {
            0% { content: '.'; }
            33% { content: '..'; }
            66% { content: '...'; }
        }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .main-content {
                padding: 20px;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                text-align: left;
            }
            
            .access-form {
                flex-direction: column;
            }
            
            .access-form .form-group {
                min-width: 100%;
            }
            
            .script-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #0d1117;
        }

        ::-webkit-scrollbar-thumb {
            background: #30363d;
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #484f58;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Lua Seel</h1>
            <p>Secure script hosting with obfuscated loader generation</p>
        </div>

        <div class="main-content">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('upload')">Upload Script</button>
                <button class="tab" onclick="switchTab('access')">Access Script</button>
                <button class="tab" onclick="switchTab('manage')">Manage Scripts</button>
            </div>

            <!-- Upload Tab -->
            <div id="upload" class="tab-content active">
                <div class="section-title">Upload Script</div>
                
                <form id="uploadForm">
                    <div class="form-group">
                        <label for="scriptName">Script Name</label>
                        <input type="text" id="scriptName" name="scriptName" placeholder="Enter script name..." required>
                    </div>
                    
                    <div class="form-group">
                        <label for="luaCode">Lua Source Code</label>
                        <textarea id="luaCode" name="luaCode" placeholder="-- Paste your Lua script here...&#10;print('Hello from Lua Seel!')&#10;game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = 100" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="description">Description (Optional)</label>
                        <input type="text" id="description" name="description" placeholder="Brief description of the script...">
                    </div>
                    
                    <button type="submit" class="btn-primary">Upload Script</button>
                </form>

                <div id="uploadResult"></div>
            </div>

            <!-- Access Tab -->
            <div id="access" class="tab-content">
                <div class="section-title">Access Script</div>
                
                <form id="accessForm" class="access-form">
                    <div class="form-group">
                        <label for="scriptId">Script ID</label>
                        <input type="text" id="scriptId" name="scriptId" placeholder="Enter script ID..." required>
                    </div>
                    
                    <div class="form-group">
                        <label for="apiKey">API Key</label>
                        <input type="text" id="apiKey" name="apiKey" placeholder="Enter API key..." required>
                    </div>
                    
                    <button type="submit" class="btn-primary">Access Script</button>
                </form>

                <div id="accessResult"></div>
            </div>

            <!-- Manage Tab -->
            <div id="manage" class="tab-content">
                <div class="section-title">Manage Scripts</div>
                <div id="scriptList" class="script-list"></div>
            </div>
        </div>
    </div>
            <div class="tabs">
                <button class="tab active" onclick="switchTab('upload')">Upload Script</button>
                <button class="tab" onclick="switchTab('access')">Access Script</button>
                <button class="tab" onclick="switchTab('manage')">Manage Scripts</button>
            </div>

            <!-- Upload Tab -->
            <div id="upload" class="tab-content active">
                <h2>Upload Lua Script</h2>
                <form id="uploadForm">
                    <div class="form-group">
                        <label for="scriptName">Script Name:</label>
                        <input type="text" id="scriptName" name="scriptName" placeholder="Enter script name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="luaCode">Lua Code:</label>
                        <textarea id="luaCode" name="luaCode" placeholder="Paste your Lua code here..." required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="description">Description (optional):</label>
                        <input type="text" id="description" name="description" placeholder="Brief description of the script">
                    </div>
                    
                    <button type="submit" class="btn">Upload & Generate Secure Loader</button>
                </form>

                <div id="uploadResult"></div>
            </div>

            <!-- Access Tab -->
            <div id="access" class="tab-content">
                <h2>Access Protected Script</h2>
                <form id="accessForm" class="access-form">
                    <div class="form-group">
                        <label for="scriptId">Script ID:</label>
                        <input type="text" id="scriptId" name="scriptId" placeholder="Enter script ID" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="apiKey">API Key:</label>
                        <input type="text" id="apiKey" name="apiKey" placeholder="Enter API key" required>
                    </div>
                    
                    <button type="submit" class="btn">Access Script</button>
                </form>

                <div id="accessResult"></div>
            </div>

            <!-- Manage Tab -->
            <div id="manage" class="tab-content">
                <h2>Manage Your Scripts</h2>
                <p>Here are all your uploaded scripts:</p>
                <div id="scriptList" class="script-list"></div>
            </div>
        </div>
    </div>

    <script>
        // In-memory storage for demo purposes
        let scripts = JSON.parse(localStorage.getItem('luaSealScripts')) || {};
        let scriptCounter = localStorage.getItem('luaSealCounter') || 1;

        // Utility functions
        function generateId(length = 8) {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < length; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        function generateAPIKey() {
            return generateId(32);
        }

        // Create WORKING obfuscated loader script - Fixed key reconstruction
        function createObfuscatedLoader(scriptId, apiKey) {
            const authKey = `${scriptId}_${apiKey}_fetch`;
            
            // Simple but reliable obfuscation - split auth key into pieces
            const keyParts = [];
            const chunkSize = 3;
            
            for (let i = 0; i < authKey.length; i += chunkSize) {
                keyParts.push(authKey.substring(i, i + chunkSize));
            }
            
            // Add dummy parts
            const dummyParts = [];
            for (let i = 0; i < 10; i++) {
                dummyParts.push(generateId(3));
            }
            
            // Combine real and dummy parts
            const allParts = [...keyParts, ...dummyParts];
            
            // Shuffle all parts
            for (let i = allParts.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [allParts[i], allParts[j]] = [allParts[j], allParts[i]];
            }
            
            // Find indices of real parts (in order)
            const realIndices = keyParts.map(part => allParts.indexOf(part));
            
            let obfuscatedLoader = `local loader = {}
local parts = {}
${allParts.map((part, index) => `parts[${index + 1}] = "${part}"`).join('\n')}

local function getAuthKey()
    local indices = {${realIndices.join(', ')}}
    local key = ""
    for _, idx in ipairs(indices) do
        key = key .. parts[idx]
    end
    return key
end

local function getUserData()
    local data = {
        timestamp = os.time(),
        session = tostring(math.random(100000, 999999))
    }
    
    if game then
        data.env = "roblox"
        data.game_id = game.GameId or 0
        data.place_id = game.PlaceId or 0
        if game.Players and game.Players.LocalPlayer then
            local player = game.Players.LocalPlayer
            data.player = {
                name = player.Name or "unknown",
                user_id = player.UserId or 0,
                account_age = player.AccountAge or 0
            }
        end
    end
    
    data.executor = "unknown"
    local executors = {"syn", "Synapse", "krnl", "KRNL", "ScriptWare", "Delta", "Fluxus", "Oxygen"}
    for _, exec in ipairs(executors) do
        if _G[exec] or (getgenv and getgenv()[exec]) then
            data.executor = exec:lower()
            break
        end
    end
    
    return data
end

local function loadScript()
    local authKey = getAuthKey()
    local serverUrl = "https://luaseel.vercel.app/api/fetch/script"
    local userData = getUserData()
    
    print("DEBUG: Reconstructed auth key:", authKey)
    print("DEBUG: Expected format: " .. "${scriptId}_${apiKey}_fetch")
    
    local requestData = {
        auth_key = authKey,
        user_data = userData,
        action = "fetch_script"
    }
    
    local success, response = pcall(function()
        local httpService = game:GetService("HttpService")
        local jsonData = httpService:JSONEncode(requestData)
        
        if request then
            return request({
                Url = serverUrl,
                Method = "POST",
                Headers = {
                    ["Content-Type"] = "application/json"
                },
                Body = jsonData
            })
        elseif http_request then
            return http_request({
                Url = serverUrl,
                Method = "POST",
                Headers = {
                    ["Content-Type"] = "application/json"
                },
                Body = jsonData
            })
        elseif syn and syn.request then
            return syn.request({
                Url = serverUrl,
                Method = "POST",
                Headers = {
                    ["Content-Type"] = "application/json"
                },
                Body = jsonData
            })
        else
            error("No HTTP method available")
        end
    end)
    
    if not success or not response then
        error("Connection failed: " .. tostring(response))
        return
    end
    
    print("DEBUG: Server response status:", response.StatusCode)
    print("DEBUG: Server response body:", response.Body:sub(1, 200) .. "...")
    
    if response.StatusCode ~= 200 then
        error("Server error " .. response.StatusCode .. ": " .. (response.Body or "Unknown error"))
        return
    end
    
    local responseData
    success, responseData = pcall(function()
        return game:GetService("HttpService"):JSONDecode(response.Body)
    end)
    
    if not success or not responseData then
        error("Invalid server response")
        return
    end
    
    if responseData.success ~= true then
        error("Authentication failed: " .. (responseData.message or "Access denied"))
        return
    end
    
    if responseData.script then
        local scriptFunc, loadError = loadstring(responseData.script)
        if not scriptFunc then
            error("Script compilation failed: " .. tostring(loadError))
            return
        end
        
        print("SUCCESS: Script loaded and executing...")
        spawn(function()
            local execSuccess, execError = pcall(scriptFunc)
            if not execSuccess then
                warn("Script execution error: " .. tostring(execError))
            end
        end)
    else
        error("No script received from server")
    end
end

spawn(function()
    wait(0.1)
    loadScript()
end)

loader.load = loadScript
loader.reload = loadScript
return loader`;
            
            return obfuscatedLoader.trim();
        }

        // Tab switching
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            if (tabName === 'manage') {
                loadScriptList();
            }
        }

        // Upload form handler - now uploads to real database
        document.getElementById('uploadForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const scriptName = formData.get('scriptName');
            const luaCode = formData.get('luaCode');
            const description = formData.get('description') || '';
            
            const scriptId = generateId(12);
            const apiKey = generateAPIKey();
            
            // Show uploading status
            document.getElementById('uploadResult').innerHTML = `
                <div class="output-panel warning">
                    <div class="prompt">Uploading script<span class="loading"></span></div>
                    <div style="margin-top: 8px; font-size: 0.8em; color: #8b949e;">
                        • Generating authentication keys<br>
                        • Establishing database connection<br>
                        • Encrypting script payload
                    </div>
                </div>
            `;
            
            try {
                // Upload to database
                const response = await fetch('/api/fetch/script', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        action: 'upload_script',
                        script_data: {
                            script_id: scriptId,
                            api_key: apiKey,
                            script_code: luaCode,
                            script_name: scriptName,
                            description: description
                        }
                    })
                });

                const result = await response.json();
                
                if (!result.success) {
                    throw new Error(result.message || 'Upload failed');
                }

                // Store locally for management (backup)
                scripts[scriptId] = {
                    name: scriptName,
                    code: luaCode,
                    description: description,
                    apiKey: apiKey,
                    created: new Date().toISOString(),
                    id: scriptId
                };
                localStorage.setItem('luaSealScripts', JSON.stringify(scripts));
                
                // Generate obfuscated loader
                const loaderCode = createObfuscatedLoader(scriptId, apiKey);
                
                const resultHtml = `
                    <div class="output-panel success">
                        <strong>✓ Upload successful</strong>
                        <div style="margin-top: 12px;">
                            <div><strong>Script ID:</strong> <code>${scriptId}</code></div>
                            <div><strong>API Key:</strong> <code>${apiKey}</code></div>
                            <div><strong>Database Key:</strong> <code>${result.auth_key || scriptId + '_' + apiKey + '_fetch'}</code></div>
                        </div>
                    </div>
                    
                    <div class="info-box">
                        <strong>⚠ Important:</strong> Save your API key securely. It cannot be recovered if lost.
                    </div>
                    
                    <div class="code-block">
                        <div style="margin-bottom: 12px; color: #79c0ff;">Secure Loader Script:</div>
                        <pre style="margin: 0; white-space: pre-wrap; word-break: break-all;">${loaderCode}</pre>
                    </div>
                    
                    <div style="text-align: center; margin: 20px 0;">
                        <button class="btn-secondary" onclick="copyToClipboard('${loaderCode.replace(/'/g, "\\'")}')">Copy Loader Script</button>
                    </div>
                    
                    <div style="background: #21262d; border: 1px solid #30363d; border-radius: 6px; padding: 16px; margin-top: 16px;">
                        <div style="font-weight: 600; margin-bottom: 12px;">How it works:</div>
                        <div style="font-size: 0.875em; line-height: 1.6; color: #8b949e;">
                            1. Your script is encrypted and stored in the database<br>
                            2. The loader reconstructs server URL and auth key from scrambled pieces<br>
                            3. Users run the loader, which fetches and executes your real script<br>
                            4. All access is logged with user analytics
                        </div>
                    </div>
                `;
                
                document.getElementById('uploadResult').innerHTML = resultHtml;
                e.target.reset();
                
            } catch (error) {
                console.error('Upload error:', error);
                document.getElementById('uploadResult').innerHTML = `
                    <div class="output-panel error">
                        <strong>✗ Upload failed</strong>
                        <div style="margin-top: 8px;">${error.message}</div>
                        <div style="margin-top: 8px; font-size: 0.8em;">Check console for details and try again.</div>
                    </div>
                `;
            }
        });

        // Access form handler - now fetches from database
        document.getElementById('accessForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const scriptId = formData.get('scriptId');
            const apiKey = formData.get('apiKey');
            const authKey = `${scriptId}_${apiKey}_fetch`;
            
            // Show loading status
            document.getElementById('accessResult').innerHTML = `
                <div class="output-panel warning">
                    <div class="prompt">Authenticating<span class="loading"></span></div>
                    <div style="margin-top: 8px; font-size: 0.8em; color: #8b949e;">
                        • Validating credentials<br>
                        • Connecting to database<br>
                        • Decrypting script
                    </div>
                </div>
            `;
            
            try {
                const response = await fetch('/api/fetch/script', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        action: 'fetch_script',
                        auth_key: authKey,
                        user_data: {
                            access_type: 'web_interface',
                            timestamp: Date.now()
                        }
                    })
                });

                const result = await response.json();
                
                if (!result.success) {
                    throw new Error(result.message || 'Access denied');
                }
                
                const resultHtml = `
                    <div class="output-panel success">
                        <strong>✓ Access granted</strong>
                        <div style="margin-top: 12px;">
                            <div><strong>Script ID:</strong> <code>${scriptId}</code></div>
                            <div><strong>Auth Key:</strong> <code>${authKey}</code></div>
                            <div><strong>Size:</strong> ${result.script.length} characters</div>
                            <div><strong>Retrieved:</strong> ${new Date().toLocaleString()}</div>
                        </div>
                    </div>
                    
                    <div class="code-block">
                        <div style="margin-bottom: 12px; color: #79c0ff;">Script Source Code:</div>
                        <pre style="margin: 0; white-space: pre-wrap;">${result.script}</pre>
                    </div>
                    
                    <div style="text-align: center; margin: 20px 0;">
                        <button class="btn-secondary" onclick="copyToClipboard('${result.script.replace(/'/g, "\\'")}')">Copy Script</button>
                    </div>
                `;
                
                document.getElementById('accessResult').innerHTML = resultHtml;
                
            } catch (error) {
                console.error('Access error:', error);
                
                // Fallback to localStorage if database fails
                if (scripts[scriptId] && scripts[scriptId].apiKey === apiKey) {
                    const script = scripts[scriptId];
                    const resultHtml = `
                        <div class="output-panel success">
                            <strong>✓ Access granted (cached)</strong>
                            <div style="margin-top: 12px;">
                                <div><strong>Name:</strong> ${script.name}</div>
                                <div><strong>Description:</strong> ${script.description || 'None'}</div>
                                <div><strong>Created:</strong> ${new Date(script.created).toLocaleString()}</div>
                            </div>
                        </div>
                        
                        <div class="info-box">
                            <strong>Note:</strong> Retrieved from local cache - database may be unavailable.
                        </div>
                        
                        <div class="code-block">
                            <div style="margin-bottom: 12px; color: #79c0ff;">Script Source Code (Cached):</div>
                            <pre style="margin: 0; white-space: pre-wrap;">${script.code}</pre>
                        </div>
                        
                        <div style="text-align: center; margin: 20px 0;">
                            <button class="btn-secondary" onclick="copyToClipboard('${script.code.replace(/'/g, "\\'")}')">Copy Script</button>
                        </div>
                    `;
                    document.getElementById('accessResult').innerHTML = resultHtml;
                } else {
                    document.getElementById('accessResult').innerHTML = `
                        <div class="output-panel error">
                            <strong>✗ Access denied</strong>
                            <div style="margin-top: 8px;">${error.message}</div>
                            <div style="margin-top: 8px; font-size: 0.8em;">
                                • Check your Script ID and API Key<br>
                                • Ensure the script exists in the database<br>
                                • Verify your network connection
                            </div>
                        </div>
                    `;
                }
            }
        });

        // Load script list
        function loadScriptList() {
            const scriptList = document.getElementById('scriptList');
            
            if (Object.keys(scripts).length === 0) {
                scriptList.innerHTML = `
                    <div class="output-panel">
                        <div style="text-align: center; color: #8b949e;">
                            No scripts uploaded yet.<br>
                            <small>Upload a script to get started.</small>
                        </div>
                    </div>
                `;
                return;
            }
            
            let html = `
                <div style="margin-bottom: 20px; font-size: 0.875em; color: #8b949e;">
                    Found ${Object.keys(scripts).length} script(s) in local storage
                </div>
            `;
            
            for (const [id, script] of Object.entries(scripts)) {
                html += `
                    <div class="script-card">
                        <div class="script-header">
                            <div>
                                <div class="script-title">${script.name}</div>
                                <div class="script-id">ID: ${id} • ${script.code.length} characters</div>
                            </div>
                            <div class="script-actions">
                                <button class="btn-secondary" onclick="copyToClipboard('${id}')">Copy ID</button>
                                <button class="btn-secondary" onclick="copyToClipboard('${script.apiKey}')">Copy Key</button>
                                <button class="btn-secondary" style="border-color: #da3633; color: #f85149;" onclick="deleteScript('${id}')">Delete</button>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 12px; font-size: 0.875em; color: #8b949e;">
                            ${script.description || 'No description provided'}
                        </div>
                        
                        <div style="font-size: 0.8em; color: #8b949e;">
                            <div><strong>Created:</strong> ${new Date(script.created).toLocaleString()}</div>
                            <div><strong>Access URL:</strong> ${window.location.origin}#${id}</div>
                        </div>
                    </div>
                `;
            }
            
            scriptList.innerHTML = html;
        }

        // Utility functions
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                // Create a clean notification
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    z-index: 9999;
                    background: #238636;
                    color: white;
                    padding: 12px 20px;
                    border-radius: 6px;
                    font-family: inherit;
                    font-size: 0.875em;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                `;
                notification.textContent = `✓ Copied to clipboard (${text.length} characters)`;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 2000);
            }).catch(() => {
                alert('Failed to copy to clipboard');
            });
        }

        function deleteScript(scriptId) {
            if (confirm(`Delete script "${scripts[scriptId].name}"?\n\nThis action cannot be undone.`)) {
                delete scripts[scriptId];
                localStorage.setItem('luaSealScripts', JSON.stringify(scripts));
                loadScriptList();
                
                // Show deletion confirmation
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    z-index: 9999;
                    background: #da3633;
                    color: white;
                    padding: 12px 20px;
                    border-radius: 6px;
                    font-family: inherit;
                    font-size: 0.875em;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                `;
                notification.textContent = '✓ Script deleted';
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 2000);
            }
        }

        // Handle direct access via URL hash
        window.addEventListener('load', function() {
            const hash = window.location.hash.substring(1);
            if (hash && scripts[hash]) {
                switchTab('access');
                document.getElementById('scriptId').value = hash;
            }
        });

        // Initialize
        loadScriptList();
    </script>
</body>
</html>