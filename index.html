<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lua Seel - Protected Script Hosting</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-content {
            padding: 40px;
        }

        .tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid #e1e8ed;
        }

        .tab {
            padding: 15px 30px;
            cursor: pointer;
            background: none;
            border: none;
            font-size: 1.1em;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            color: #3498db;
            border-bottom-color: #3498db;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input, .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 200px;
            font-family: 'Courier New', monospace;
        }

        .btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
        }

        .result-box {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }

        .key-display {
            background: #e8f5e8;
            border: 2px solid #28a745;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            word-break: break-all;
        }

        .error {
            background: #f8d7da;
            border: 2px solid #dc3545;
            color: #721c24;
        }

        .success {
            background: #d4edda;
            border: 2px solid #28a745;
            color: #155724;
        }

        .script-list {
            margin-top: 30px;
        }

        .script-item {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            transition: box-shadow 0.3s;
        }

        .script-item:hover {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .script-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .script-id {
            font-family: 'Courier New', monospace;
            color: #666;
        }

        .copy-btn {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
        }

        .access-form {
            display: flex;
            gap: 10px;
            align-items: end;
        }

        .access-form .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåô Lua Seel</h1>
            <p>Secure Remote Script Execution with Obfuscated Loaders</p>
        </div>

        <div class="main-content">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('upload')">Upload Script</button>
                <button class="tab" onclick="switchTab('access')">Access Script</button>
                <button class="tab" onclick="switchTab('manage')">Manage Scripts</button>
            </div>

            <!-- Upload Tab -->
            <div id="upload" class="tab-content active">
                <h2>Upload Lua Script</h2>
                <form id="uploadForm">
                    <div class="form-group">
                        <label for="scriptName">Script Name:</label>
                        <input type="text" id="scriptName" name="scriptName" placeholder="Enter script name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="luaCode">Lua Code:</label>
                        <textarea id="luaCode" name="luaCode" placeholder="Paste your Lua code here..." required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="description">Description (optional):</label>
                        <input type="text" id="description" name="description" placeholder="Brief description of the script">
                    </div>
                    
                    <button type="submit" class="btn">Upload & Generate Secure Loader</button>
                </form>

                <div id="uploadResult"></div>
            </div>

            <!-- Access Tab -->
            <div id="access" class="tab-content">
                <h2>Access Protected Script</h2>
                <form id="accessForm" class="access-form">
                    <div class="form-group">
                        <label for="scriptId">Script ID:</label>
                        <input type="text" id="scriptId" name="scriptId" placeholder="Enter script ID" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="apiKey">API Key:</label>
                        <input type="text" id="apiKey" name="apiKey" placeholder="Enter API key" required>
                    </div>
                    
                    <button type="submit" class="btn">Access Script</button>
                </form>

                <div id="accessResult"></div>
            </div>

            <!-- Manage Tab -->
            <div id="manage" class="tab-content">
                <h2>Manage Your Scripts</h2>
                <p>Here are all your uploaded scripts:</p>
                <div id="scriptList" class="script-list"></div>
            </div>
        </div>
    </div>

    <script>
        // In-memory storage for demo purposes
        let scripts = JSON.parse(localStorage.getItem('luaSealScripts')) || {};
        let scriptCounter = localStorage.getItem('luaSealCounter') || 1;

        // Utility functions
        function generateId(length = 8) {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < length; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        function generateAPIKey() {
            return generateId(32);
        }

        // Create obfuscated loader script that fetches the real script
        function createObfuscatedLoader(scriptId, apiKey) {
            const baseKey = scriptId + '_' + apiKey + '_fetch';
            const parts = [];
            const serverParts = ['luaseel', 'vercel', 'app'];
            const endpointParts = ['api', 'fetch', 'script'];
            
            // Break the key into random sized chunks
            let remaining = baseKey;
            while (remaining.length > 0) {
                const chunkSize = Math.floor(Math.random() * 4) + 2;
                const chunk = remaining.substring(0, chunkSize);
                remaining = remaining.substring(chunkSize);
                parts.push(chunk);
            }
            
            // Add server URL parts disguised as random chunks
            serverParts.forEach(part => parts.push(part));
            endpointParts.forEach(part => parts.push(part));
            
            // Add many dummy parts to confuse analysis
            for (let i = 0; i < 15; i++) {
                parts.push(generateId(Math.floor(Math.random() * 6) + 2));
            }
            
            // Shuffle all parts multiple times
            for (let shuffle = 0; shuffle < 3; shuffle++) {
                for (let i = parts.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [parts[i], parts[j]] = [parts[j], parts[i]];
                }
            }
            
            // Find indices for reconstruction
            const keyIndices = [];
            const serverIndices = [];
            const endpointIndices = [];
            
            let keyChunks = [];
            let remaining2 = baseKey;
            while (remaining2.length > 0) {
                const chunkSize = Math.floor(Math.random() * 4) + 2;
                const chunk = remaining2.substring(0, chunkSize);
                remaining2 = remaining2.substring(chunkSize);
                keyChunks.push(chunk);
            }
            
            keyChunks.forEach(chunk => {
                keyIndices.push(parts.indexOf(chunk));
            });
            
            serverParts.forEach(part => {
                serverIndices.push(parts.indexOf(part));
            });
            
            endpointParts.forEach(part => {
                endpointIndices.push(parts.indexOf(part));
            });
            
            let obfuscatedLoader = `local loader = {}
local chunks = {}
${parts.map((part, index) => `chunks[${index + 1}] = "${part}"`).join('\n')}

local function buildKey()
    local indices = {${keyIndices.join(', ')}}
    local key = ""
    for _, idx in ipairs(indices) do
        if chunks[idx] then
            key = key .. chunks[idx]
        end
    end
    return key
end

local function buildServer()
    local indices = {${serverIndices.join(', ')}}
    local parts = {}
    for _, idx in ipairs(indices) do
        if chunks[idx] then
            table.insert(parts, chunks[idx])
        end
    end
    return "https://" .. table.concat(parts, ".") .. "/"
end

local function buildEndpoint()
    local indices = {${endpointIndices.join(', ')}}
    local parts = {}
    for _, idx in ipairs(indices) do
        if chunks[idx] then
            table.insert(parts, chunks[idx])
        end
    end
    return table.concat(parts, "/")
end

local function collectUserData()
    local userData = {
        timestamp = os.time(),
        session_id = tostring(math.random(100000, 999999)) .. "_" .. tostring(os.time())
    }
    
    if game then
        userData.env = "roblox"
        userData.game_id = game.GameId or 0
        userData.place_id = game.PlaceId or 0
        if game.Players and game.Players.LocalPlayer then
            local player = game.Players.LocalPlayer
            userData.player = {
                name = player.Name or "unknown",
                user_id = player.UserId or 0,
                account_age = player.AccountAge or 0
            }
        end
    elseif jit then
        userData.env = "luajit"
        userData.version = jit.version or "unknown"
    else
        userData.env = "lua"
        userData.version = _VERSION or "unknown"
    end
    
    userData.executor = "unknown"
    local executors = {
        "syn", "Synapse", "krnl", "KRNL", "ScriptWare", 
        "Oxygen", "Sentinel", "Proxo", "SirHurt", "Fluxus"
    }
    for _, exec in ipairs(executors) do
        if _G[exec] or (getgenv and getgenv()[exec]) then
            userData.executor = exec:lower()
            break
        end
    end
    
    return userData
end

local function loadScript()
    local authKey = buildKey()
    local serverUrl = buildServer()
    local endpoint = buildEndpoint()
    local fullUrl = serverUrl .. endpoint
    
    local userData = collectUserData()
    
    local requestData = {
        auth_key = authKey,
        user_data = userData,
        action = "fetch_script"
    }
    
    local success, response = pcall(function()
        local httpService = game:GetService("HttpService")
        local jsonData = httpService:JSONEncode(requestData)
        
        if syn and syn.request then
            return syn.request({
                Url = fullUrl,
                Method = "POST",
                Headers = {
                    ["Content-Type"] = "application/json",
                    ["User-Agent"] = "LuaSeel-Loader/1.0"
                },
                Body = jsonData
            })
        elseif http_request then
            return http_request({
                Url = fullUrl,
                Method = "POST", 
                Headers = {
                    ["Content-Type"] = "application/json",
                    ["User-Agent"] = "LuaSeel-Loader/1.0"
                },
                Body = jsonData
            })
        elseif request then
            return request({
                Url = fullUrl,
                Method = "POST",
                Headers = {
                    ["Content-Type"] = "application/json",
                    ["User-Agent"] = "LuaSeel-Loader/1.0"
                },
                Body = jsonData
            })
        else
            error("No HTTP method available")
        end
    end)
    
    if not success or not response then
        error("Failed to connect to Lua Seel server: " .. tostring(response))
        return
    end
    
    if response.StatusCode ~= 200 then
        error("Server returned error: " .. tostring(response.StatusCode))
        return
    end
    
    local responseData
    success, responseData = pcall(function()
        return game:GetService("HttpService"):JSONDecode(response.Body)
    end)
    
    if not success or not responseData then
        error("Invalid response from server")
        return
    end
    
    if responseData.success ~= true then
        error("Authentication failed: " .. (responseData.message or "Unknown error"))
        return
    end
    
    if responseData.script then
        local scriptFunc, loadError = loadstring(responseData.script)
        if not scriptFunc then
            error("Script compilation error: " .. tostring(loadError))
            return
        end
        
        spawn(function()
            local execSuccess, execError = pcall(scriptFunc)
            if not execSuccess then
                warn("Script execution error: " .. tostring(execError))
            end
        end)
    else
        error("No script received from server")
    end
end

spawn(function()
    wait(0.1)
    loadScript()
end)

loader.load = loadScript
loader.reload = loadScript
return loader`;
            
            return obfuscatedLoader.trim();
        }

        // Tab switching
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            if (tabName === 'manage') {
                loadScriptList();
            }
        }

        // Upload form handler
        document.getElementById('uploadForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const scriptName = formData.get('scriptName');
            const luaCode = formData.get('luaCode');
            const description = formData.get('description') || '';
            
            const scriptId = generateId(12);
            const apiKey = generateAPIKey();
            const timestamp = new Date().toISOString();
            
            // Store script
            scripts[scriptId] = {
                name: scriptName,
                code: luaCode,
                description: description,
                apiKey: apiKey,
                created: timestamp,
                id: scriptId
            };
            
            // Save to localStorage
            localStorage.setItem('luaSealScripts', JSON.stringify(scripts));
            localStorage.setItem('luaSealCounter', parseInt(scriptCounter) + 1);
            
            // Generate obfuscated loader
            const loaderCode = createObfuscatedLoader(scriptId, apiKey);
            
            const resultHtml = `
                <div class="result-box success">
                    <strong>‚úÖ Script uploaded successfully!</strong><br><br>
                    <strong>Script ID:</strong> ${scriptId}<br>
                    <strong>API Key:</strong> ${apiKey}<br>
                    <strong>Access URL:</strong> ${window.location.origin}#${scriptId}<br><br>
                    <div class="key-display">
                        <strong>üîê Save this API key safely - you'll need it to access your script!</strong>
                    </div>
                </div>
                
                <div class="result-box">
                    <strong>üîê Secure Loader Script (Ready for Moonsec Obfuscation):</strong><br>
                    <small>This loader fetches your real script from luaseel.vercel.app - the original code is never exposed!</small><br><br>
                    <textarea readonly style="width: 100%; height: 250px; font-family: monospace;">${loaderCode}</textarea>
                    <button class="copy-btn" onclick="copyToClipboard('${loaderCode.replace(/'/g, "\\'")}')">Copy Loader Script</button>
                </div>
                
                <div class="result-box" style="background: #e8f5e8; border-color: #28a745;">
                    <strong>üõ°Ô∏è Security Features:</strong><br>
                    ‚Ä¢ <strong>Remote Fetching:</strong> Real script is fetched from luaseel.vercel.app<br>
                    ‚Ä¢ <strong>Obfuscated Keys:</strong> Server URL + auth key broken into 20+ scrambled pieces<br>
                    ‚Ä¢ <strong>Auto Analytics:</strong> Collects user data (executor, environment, player info)<br>
                    ‚Ä¢ <strong>Multi-HTTP Support:</strong> Works with Synapse, KRNL, and other executors<br>
                    ‚Ä¢ <strong>Error Handling:</strong> Proper authentication and connection validation<br><br>
                    
                    <strong>‚ö° How It Works:</strong><br>
                    1. User runs your loader script (obfuscated with Moonsec)<br>
                    2. Loader reconstructs server URL and auth key from scrambled pieces<br>
                    3. Connects to <code>luaseel.vercel.app/api/fetch/script</code><br>
                    4. Verifies auth key and fetches your real script<br>
                    5. Executes the real script seamlessly<br>
                    
                    <br><em>üéØ Original script is never visible in the loader code!</em>
                </div>
            `;
            
            document.getElementById('uploadResult').innerHTML = resultHtml;
            e.target.reset();
        });

        // Access form handler
        document.getElementById('accessForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const scriptId = formData.get('scriptId');
            const apiKey = formData.get('apiKey');
            
            if (!scripts[scriptId]) {
                document.getElementById('accessResult').innerHTML = 
                    '<div class="result-box error">‚ùå Script not found!</div>';
                return;
            }
            
            const script = scripts[scriptId];
            if (script.apiKey !== apiKey) {
                document.getElementById('accessResult').innerHTML = 
                    '<div class="result-box error">‚ùå Invalid API key!</div>';
                return;
            }
            
            const resultHtml = `
                <div class="result-box success">
                    <strong>‚úÖ Access granted!</strong><br><br>
                    <strong>Script Name:</strong> ${script.name}<br>
                    <strong>Description:</strong> ${script.description || 'No description'}<br>
                    <strong>Created:</strong> ${new Date(script.created).toLocaleString()}<br>
                </div>
                
                <div class="result-box">
                    <strong>üìú Original Script Code:</strong><br><br>
                    <textarea readonly style="width: 100%; height: 300px; font-family: monospace;">${script.code}</textarea>
                    <button class="copy-btn" onclick="copyToClipboard('${script.code.replace(/'/g, "\\'")}')">Copy Original Script</button>
                </div>
            `;
            
            document.getElementById('accessResult').innerHTML = resultHtml;
        });

        // Load script list
        function loadScriptList() {
            const scriptList = document.getElementById('scriptList');
            
            if (Object.keys(scripts).length === 0) {
                scriptList.innerHTML = '<p>No scripts uploaded yet.</p>';
                return;
            }
            
            let html = '';
            for (const [id, script] of Object.entries(scripts)) {
                html += `
                    <div class="script-item">
                        <div class="script-meta">
                            <div>
                                <strong>${script.name}</strong>
                                <span class="script-id">ID: ${id}</span>
                            </div>
                            <div>
                                <button class="copy-btn" onclick="copyToClipboard('${id}')">Copy ID</button>
                                <button class="copy-btn" onclick="copyToClipboard('${script.apiKey}')">Copy Key</button>
                                <button class="copy-btn" style="background: #dc3545;" onclick="deleteScript('${id}')">Delete</button>
                            </div>
                        </div>
                        <p><strong>Description:</strong> ${script.description || 'No description'}</p>
                        <p><strong>Created:</strong> ${new Date(script.created).toLocaleString()}</p>
                        <p><strong>Access URL:</strong> ${window.location.origin}#${id}</p>
                    </div>
                `;
            }
            
            scriptList.innerHTML = html;
        }

        // Utility functions
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('Copied to clipboard!');
            });
        }

        function deleteScript(scriptId) {
            if (confirm('Are you sure you want to delete this script?')) {
                delete scripts[scriptId];
                localStorage.setItem('luaSealScripts', JSON.stringify(scripts));
                loadScriptList();
            }
        }

        // Handle direct access via URL hash
        window.addEventListener('load', function() {
            const hash = window.location.hash.substring(1);
            if (hash && scripts[hash]) {
                switchTab('access');
                document.getElementById('scriptId').value = hash;
            }
        });

        // Initialize
        loadScriptList();
    </script>
</body>
</html>